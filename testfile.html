
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aadhav Sivakumar | Design & Development Portfolio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    /* FONT & THEME */
    :root {
      --primary-color: #1a1a1a;
      --secondary-color: #555555;
      --background-color: #F7F5F2;
      --surface-color: #FFFFFF;
      --accent-color: #BFA181;
      --animation-duration: 0.65s;
      --animation-easing: cubic-bezier(0.76, 0, 0.24, 1);
    }

    /* Keyframe animation for the breathing effect */
    @keyframes breathe-animation {
      0% { transform: translateX(0) translateY(0); }
      50% { transform: translateX(0) translateY(-8px); }
      100% { transform: translateX(0) translateY(0); }
    }

    /* GLOBAL STYLES */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--background-color);
      color: var(--primary-color);
      line-height: 1.7;
      overflow-x: hidden;
    }

    h1, h2, h3, h4 { font-family: 'Playfair Display', serif; font-weight: 700; }
    a { color: var(--accent-color); text-decoration: none; transition: color 0.3s ease; }
    a:hover { color: var(--primary-color); }

    /* ANIMATED OBJECTS & HEADER */
    .animated-object { position: fixed; background-color: var(--accent-color); opacity: 0.5; z-index: 1; transition: transform 0.1s linear; will-change: transform; }
    .left-object { width: 80px; height: 80px; border-radius: 50%; left: 10vw; top: 85vh; }
    .right-object { width: 100px; height: 100px; right: 8vw; top: 0; transform: translateY(-100%); }
    header { position: fixed; width: 100%; top: 0; left: 0; padding: 20px 5%; display: flex; justify-content: space-between; align-items: center; z-index: 1000; transition: background-color 0.5s ease, box-shadow 0.5s ease; }
    header.scrolled { background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    header .logo { font-size: 1.5rem; }
    header nav a { margin-left: 30px; }

    /* SECTION & CARD STYLES */
    section { padding: 100px 5%; max-width: 1200px; margin: 0 auto; opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease, transform 0.8s ease; position: relative; z-index: 10; }
    section#about { /* Reduced padding for the about section */
      padding: 50px 5% 50px 5%;
    }
    section.visible { opacity: 1; transform: translateY(0); }
    .section-title { font-size: 3rem; margin-bottom: 40px; text-align: center; }
    #hero { min-height: 50vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background-color: transparent; }
    #hero h1 { font-size: clamp(2.5rem, 6vw, 6rem); margin-bottom: 20px; }
    #hero p { font-size: clamp(1rem, 2vw, 1.25rem); color: var(--secondary-color); font-family: 'Poppins'; }

    .about-card-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .about-me-card {
      max-width: 600px;
      width: 100%;
    }
    .about-me-card img {
      width: 100%;
      height: auto;
      aspect-ratio: 1 / 1;
      object-fit: cover;
    }


    #projects h3 { font-size: 1.8rem; margin-top: 60px; margin-bottom: 20px; text-align: center; color: var(--secondary-color); font-family: 'Poppins'; font-weight: 400; }

    .major-project-card, .small-project-card, .skill-card {
      cursor: pointer;
      opacity: 0;
      visibility: visible;
      transition: opacity 0.5s ease-out, transform 0.5s ease, box-shadow 0.4s ease;
    }

    .project-modal-trigger.animating-out {
      opacity: 0 !important;
      transform: scale(0.95) !important;
      visibility: hidden;
      transition: opacity 0.2s ease, transform 0.2s ease, visibility 0s linear 0.2s;
    }

    .major-project-card:nth-child(odd), .small-project-card:nth-child(odd), .skill-card:nth-child(odd) { transform: translateX(-50px); }
    .major-project-card:nth-child(even), .small-project-card:nth-child(even), .skill-card:nth-child(even) { transform: translateX(50px); }

    .about-me-card {
      transform: translateY(30px);
    }


    .major-project-card.in-view, .small-project-card.in-view, .skill-card.in-view {
      opacity: 1;
      transform: translateX(0);
    }
    .about-me-card.in-view {
      opacity: 1;
      transform: translateY(0);
    }


    .major-project-card:hover,
    .small-project-card:hover,
    .skill-card:hover {
      animation: breathe-animation 2s ease-in-out infinite;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1), 0 0 15px rgba(212, 175, 55, 0.5);
    }

    .major-projects-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; }
    .major-project-card { background-color: var(--surface-color); border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .major-project-card img { width: 100%; height: 300px; object-fit: cover; }
    .major-project-card .project-content { padding: 25px; }
    .major-project-card h4 { font-size: 1.7rem; }
    .major-project-card p { color: var(--secondary-color); }
    .small-projects-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; }
    .small-project-card { background-color: var(--surface-color); border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); overflow: hidden; }
    .small-project-card img { width: 100%; height: 150px; object-fit: cover; display: block; }
    .small-project-content { padding: 15px; }
    .small-project-content h4 { font-family: 'Poppins'; font-weight: 600; font-size: 1.1rem; margin-bottom: 5px; }
    .small-project-content p { font-size: 0.9rem; color: var(--secondary-color); }

    .skill-category-title {
      font-size: 1.8rem;
      margin-top: 60px;
      margin-bottom: 20px;
      text-align: center;
      color: var(--secondary-color);
      font-family: 'Poppins';
      font-weight: 400;
    }

    .skills-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr); /* Default: 8 columns */
      gap: 15px; /* Adjusted gap for smaller cards */
    }

    .skill-card {
      background-color: var(--surface-color);
      border-radius: 10px;
      padding: 12px 6px; /* Reduced padding */
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 140px; /* Reduced height */
    }

    .skill-card img {
      height: 50px; /* Reduced image size */
      width: 50px;  /* Reduced image size */
      margin-bottom: 10px; /* Adjusted margin */
      object-fit: contain;
    }

    .skill-card span {
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      font-size: 0.8rem; /* Reduced font size */
      line-height: 1.2;
      color: var(--secondary-color);
    }

    #contact p, #resume p {
      max-width: 600px;
      margin: 0 auto 40px;
      color: var(--secondary-color);
      text-align: center;
    }
    #contact { text-align: center; }
    .social-links { margin-top: 40px; display: flex; justify-content: center; gap: 35px; align-items: center; }
    .social-links a { color: var(--secondary-color); transition: transform 0.3s ease, color 0.3s ease; display: inline-block; }
    .social-links a:hover { transform: scale(1.25); color: var(--accent-color); }
    footer { text-align: center; padding: 40px 5%; color: var(--secondary-color); font-size: 0.9rem; border-top: 1px solid #ddd; margin-top: 50px; position: relative; z-index: 10; }

    #resume-iframe {
      width: 100%;
      height: 800px;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-top: 20px;
    }

    /* MODAL STYLES */
    .modal-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 2000; opacity: 0; transition: opacity 0.5s ease-in-out; pointer-events: none;}
    .modal-backdrop.visible { opacity: 1; pointer-events: auto; }
    .modal-animator { position: fixed; background-color: var(--surface-color); border-radius: 10px; z-index: 2001; overflow: hidden;
      transition: top var(--animation-duration) var(--animation-easing),
      left var(--animation-duration) var(--animation-easing),
      width var(--animation-duration) var(--animation-easing),
      height var(--animation-duration) var(--animation-easing),
      opacity var(--animation-duration) var(--animation-easing); /* Added opacity transition */
      pointer-events: none; visibility: hidden; opacity: 0; /* Start transparent for all */
    }
    .modal-animator.no-transition { transition: none !important; }
    .modal-animator.visible { pointer-events: auto; visibility: visible; opacity: 1; /* Target opacity for visible state */ }
    .modal-animator .modal-content-wrapper { opacity: 0; transition: opacity 0.3s 0.2s ease; } /* Content fade-in after modal shell animation */
    .modal-animator.open .modal-content-wrapper { opacity: 1; }

    .modal-content {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .modal-content-wrapper {
      width: 100%;
      height: 100%;
      overflow-y: auto;
    }

    .modal-image-container {
      width: 100%;
      padding: 50px 35px 0;
    }

    .modal-image {
      width: 100%;
      height: auto;
      max-height: 50vh;
      object-fit: cover;
      border-radius: 8px;
    }

    .modal-animator.skill-modal .modal-image-container {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #f0f0f0;
      border-radius: 8px;
      width: calc(100% - 70px);
      margin: 50px auto 25px;
      aspect-ratio: 1 / 1;
      padding: 20px;
    }

    .modal-animator.skill-modal .modal-image {
      width: auto;
      height: auto;
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 0;
    }


    .modal-view-button {
      display: inline-block;
      padding: 12px 24px;
      background-color: var(--accent-color);
      color: var(--surface-color) !important;
      border-radius: 5px;
      font-weight: 600;
      text-align: center;
      transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
      margin-top: 15px; /* Added margin for spacing */
    }
    .modal-view-button:hover {
      transform: scale(1.05);
      background-color: var(--primary-color);
      color: var(--surface-color) !important;
    }

    .modal-close { position: fixed; top: 15px; right: 20px; background: none; border: none; font-size: 2.5rem; cursor: pointer; line-height: 1; z-index: 2002; color: white; mix-blend-mode: difference;}
    .modal-animator.skill-modal .modal-close {
      color: #333;
      mix-blend-mode: normal;
    }

    .modal-text-content { padding: 25px 35px; }
    .modal-text-content h2 { margin-bottom: 15px; font-size: 2.5rem; }
    .modal-text-content p#modal-description { margin-bottom: 20px; white-space: pre-wrap; line-height: 1.7;}

    /* Styles for dynamically added content */
    .modal-dynamic-text {
      margin-bottom: 20px;
      white-space: pre-wrap;
      line-height: 1.7;
    }
    .modal-dynamic-image {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 20px auto; /* Centered block image */
      display: block;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .modal-dynamic-button {
      display: inline-block;
      padding: 10px 20px;
      background-color: var(--accent-color);
      color: var(--surface-color) !important;
      border-radius: 5px;
      font-weight: 600;
      text-align: center;
      margin: 10px 5px 15px 0;
      transition: transform 0.3s ease, background-color 0.3s ease;
    }
    .modal-dynamic-button:hover {
      transform: scale(1.05);
      background-color: var(--primary-color);
    }

    /* RESPONSIVE DESIGN */
    @media (max-width: 1200px) {
      .skills-grid { grid-template-columns: repeat(6, 1fr); }
    }
    @media (max-width: 1024px) {
      .skills-grid { grid-template-columns: repeat(5, 1fr); }
    }
    @media (max-width: 768px) {
      .skills-grid { grid-template-columns: repeat(4, 1fr); }
      header nav a { margin-left: 15px; }
      .section-title { font-size: 2.5rem; }
      .modal-content-wrapper { padding: 20px; } /* Applies to scroll wrapper */
      .modal-image-container { padding: 30px 15px 0; }
      .modal-text-content { padding: 25px 15px; } /* Main text padding */
      .modal-text-content h2 { font-size: 2rem; }
      #resume-iframe { height: 600px; }
    }
    @media (max-width: 600px) {
      .skills-grid { grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 480px) {
      .skills-grid { grid-template-columns: repeat(2, 1fr); }
      #resume-iframe { height: 500px; }
    }
  </style>
</head>
<body>

<div class="animated-object left-object"></div>
<div class="animated-object right-object"></div>

<header>
  <div class="logo"><a href="#hero">AS.</a></div>
  <nav>
    <a href="#about">About</a>
    <a href="#projects">Projects</a>
    <a href="#skills">Skills</a>
    <a href="#resume">Resume</a>
    <a href="#contact">Contact</a>
  </nav>
</header>

<main>
  <section id="hero" class="visible">
    <h1>Aadhav Sivakumar</h1>
    <p>Robotics and Embedded Systems Engineer</p>
  </section>

  <section id="about">
    <div class="about-card-wrapper">
      <!-- About Me card will be injected here by JavaScript -->
    </div>
  </section>

  <section id="projects">
    <h2 class="section-title">My Work</h2>
    <h3>Major Projects</h3>
    <div class="major-projects-grid" id="major-projects-container"></div>
    <h3>More Work</h3>
    <div class="small-projects-grid" id="small-projects-container"></div>
  </section>

  <section id="skills">
    <h2 class="section-title">Technical Skills</h2>
    <div id="skills-container"></div>
  </section>

  <section id="resume">
    <h2 class="section-title">My Resume</h2>
    <p>Explore my professional experience, skills, and qualifications in detail. My resume is displayed below.</p>
    <embed id="resume-iframe" type="application/pdf" title="Aadhav Sivakumar's Resume">
  </section>

  <section id="contact">
    <h2 class="section-title">Get In Touch</h2>
    <p>I'm currently available for new opportunities. If you have a project in mind or just want to connect, I'd love to hear from you!</p>
    <div class="social-links">
      <a href="https://www.linkedin.com/in/aadhav-s/" target="_blank" aria-label="LinkedIn Profile">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="40" height="40"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.225 0z" /></svg>
      </a>
      <a href="https://github.com/AadhavSivakumar" target="_blank" aria-label="GitHub Profile">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="40" height="40"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" /></svg>
      </a>
      <a href="mailto:sivakumaadhav@gmail.com" aria-label="Email">
        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
      </a>
    </div>
  </section>
</main>

<footer>
  <p>Â© 2024 Aadhav Sivakumar. All Rights Reserved.</p>
</footer>

<!-- Modal Structure -->
<div class="modal-backdrop">
  <div class="modal-animator">
    <div class="modal-content">
      <button class="modal-close">&times;</button>
      <div class="modal-content-wrapper">
        <div class="modal-image-container">
          <img src="" alt="" class="modal-image"/>
        </div>
        <div class="modal-text-content">
          <h2 id="modal-title"></h2>
          <p id="modal-description"></p> <!-- Used for items NOT using modalContent (e.g. skills) -->
          <!-- Dynamic content for 'About Me' and projects will be inserted here before #modal-tech-stack -->
          <div id="modal-tech-stack"></div>
          <a href="#" target="_blank" rel="noopener noreferrer" class="modal-view-button" id="modal-link">View Project</a>
        </div>
      </div>
    </div>
  </div>
</div>


<script>
  window.addEventListener('load', () => {

    const resumePdfUrl = 'https://aadhavsivakumar.github.io/Resume/Aadhav_Sivakumar_Resume_20250616_2.pdf';
    const longLorem = "This is a placeholder description that should be replaced with meaningful content for each project. It describes the project in more detail than the card itself, outlining the challenge, solution, and technologies used. This detailed view helps users understand the scope and impact of the work presented."

    const aboutMeData = {
      id: 'about-me-section',
      type: 'about',
      cardTitle: 'About Me',
      cardTeaser: 'A glimpse into my life experiences, skills, and the passions that drive my engineering pursuits. Click to learn more.',
      imageUrl: 'https://aadhavsivakumar.github.io/Images/frontpagepfp.JPG',
      modalTitle: 'Aadhav Sivakumar',
      modalContent: [
        { type: 'text', value: "Hello! I'm Aadhav Sivakumar, a passionate Robotics and Embedded Systems Engineer hailing from the Bay Area in California. My journey in engineering started from Dublin High School, through my undergraduate studies at University of California, Santa Cruz, and now to New York, where I am currently a Master's in Mechatronics and Robotics at NYU Tandon." },
        { type: 'image', value: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=60', alt: 'My desk setup' },
        { type: 'text', value: "I am driven by the challenge of creating intelligent systems and thrive on developing cutting-edge solutions in the world of robotics and embedded technology. Apart from my engineering interests, I like to play volleyball and go biking through the streets of Brooklyn and Manhattan." },
        { type: 'button', text: 'Connect on LinkedIn', link: 'https://www.linkedin.com/in/aadhav-s/' },
        { type: 'text', value: "Feel free to explore my projects or reach out if you'd like to collaborate!" }
      ]
    };

    const majorProjectsData = [
      { id: 1, title: 'Project Millet', cardDescription: 'Agricultural drone for spraying trees with water and pesticides.', imageUrl: 'https://images.unsplash.com/photo-1558655146-d09347e92766?q=80&w=2564&auto=format&fit=crop', modalContent: [{type: 'text', value: longLorem}, {type: 'button', text: 'View Project', link: '#'}] },
      { id: 2, title: 'SoleGait', cardDescription: 'Smart sensor placed in shoe for advanced gait analysis.', imageUrl: 'https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?q=80&w=2670&auto=format&fit=crop', modalContent: [{type: 'text', value: longLorem}, {type: 'button', text: 'View Project', link: '#'}] },
      { id: 3, title: 'Glass2Bot', cardDescription: 'Human mounted AI vision for remote object manipulation.', imageUrl: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=2670&auto=format&fit=crop', modalContent: [{type: 'text', value: longLorem}, {type: 'button', text: 'View Project', link: '#'}] },
      { id: 4, title: 'SMART compost sorting', cardDescription: 'A Franka Panda and depth camera used to filter compost stream.', imageUrl: 'https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?q=80&w=2670&auto=format&fit=crop', modalContent: [{type: 'text', value: longLorem}, {type: 'button', text: 'View Project', link: '#'}] },
      { id: 5, title: 'Tactile Manipulation sensor', cardDescription: 'Soft robotics sensor on a flexible PCB to determine amount and sheering direction of gripping force.', imageUrl: 'https://images.unsplash.com/photo-1624329929555-531e27874411?q=80&w=2670&auto=format&fit=crop', modalContent: [{type: 'text', value: longLorem}, {type: 'button', text: 'View Project', link: '#'}] },
      { id: 6, title: 'Stockbot', cardDescription: 'Simulation of robot restocking items with optimal path.', imageUrl: 'https://images.unsplash.com/photo-1515879218367-8466d910aaa4?q=80&w=2669&auto=format&fit=crop', modalContent: [{type: 'text', value: longLorem}, {type: 'button', text: 'View Project', link: 'https://sites.google.com/ucsc.edu/stockbot/home'}] },
    ];

    const smallProjectsData = [
      { id: 'a', title: 'Sand Table', imageUrl: 'https://images.unsplash.com/photo-1518770660439-4636190af475?w=400', modalContent: [{type: 'text', value: '2r manipulator to create patterns in the sand.'}] },
      { id: 'b', title: 'PONG', imageUrl: 'https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=400', modalContent: [{type: 'text', value: 'Recreation of PONG with an LED matrix.'}] },
      { id: 'c', title: 'MATE ROV', imageUrl: 'https://images.unsplash.com/photo-1522199755839-a2bacb67c546?q=80&w=2672&auto=format&fit=crop', modalContent: [{type: 'text', value: 'Underwater drone completing complex tasks as a part of MATE ROV competition.'}] },
      { id: 'd', title: 'Automated Dog Feeder', imageUrl: 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?w=400', modalContent: [{type: 'text', value: 'system that allows dog to get correct portion of food remotely.'}] },
      { id: 'e', title: 'FPGA VGA Game', imageUrl: 'https://images.unsplash.com/photo-1579882392322-8173d15517e3?q=80&w=2670&auto=format&fit=crop', modalContent: [{type: 'text', value: 'simple flappy bird style game implemented on basys 3 FPGA'}] },
      { id: 'f', title: 'Mechatronics Competition', imageUrl: 'https://images.unsplash.com/photo-1550745165-9bc0b252726a?w=400', modalContent: [{type: 'text', value: 'Robot that competes in a ping pong shooting tournament as part of mechatronics class'}] },
      { id: 'g', title: 'Project G', imageUrl: 'https://images.unsplash.com/photo-1534972195531-d756b9bfa9f2?w=400', modalContent: [{type: 'text', value: 'A short description for this small but cool project.'}] },
      { id: 'h', title: 'Project H', imageUrl: 'https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=400', modalContent: [{type: 'text', value: 'A short description for this small but cool project.'}] },
      { id: 'i', title: 'Project I', imageUrl: 'https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?w=400', modalContent: [{type: 'text', value: 'A short description for this small but cool project.'}] },
      { id: 'j', title: 'Project J', imageUrl: 'https://images.unsplash.com/photo-1596726805581-8072ee427e41?w=400', modalContent: [{type: 'text', value: 'A short description for this small but cool project.'}] },
      { id: 'k', title: 'Project K', imageUrl: 'https://images.unsplash.com/photo-1537432376769-00f5c2f4c8d2?w=400', modalContent: [{type: 'text', value: 'A short description for this small but cool project.'}] },
      { id: 'l', title: 'Project L', imageUrl: 'https://images.unsplash.com/photo-1587620962725-abab7fe55159?w=400', modalContent: [{type: 'text', value: 'A short description for this small but cool project.'}] },
    ];

    const baseSkillImagePath = 'https://aadhavsivakumar.github.io/Images/skills/';

    const skillsData = [
      { category: 'Hardware', items: [
          { name: 'Franka Emika Robot', imageUrl: baseSkillImagePath + 'Franka-Emika-Panda-robot.png', description: 'The Franka Emika Panda is a collaborative robot arm designed for research and industrial applications. It features 7 degrees of freedom, sensitive torque sensors in all joints, and an intuitive programming interface, making it suitable for human-robot interaction and complex manipulation tasks.' },
          { name: 'NI DAQ', imageUrl: baseSkillImagePath + 'NIDAQ.jpg', description: 'National Instruments Data Acquisition (NI DAQ) hardware is used for measuring electrical or physical phenomena such as voltage, current, temperature, pressure, or sound. It converts real-world signals into digital data that can be processed and analyzed by a computer.' },
          { name: 'Google Glass', imageUrl: baseSkillImagePath + 'googleglass.jpg', description: 'Google Glass is an optical head-mounted display designed in the shape of a pair of eyeglasses. It provides a hands-free way to access information and applications, displaying content directly in the user\'s field of vision, often used for augmented reality and remote assistance.' },
          { name: 'Bambu Lab Printer', imageUrl: baseSkillImagePath + 'bambu.webp', description: 'Bambu Lab 3D printers are known for their high-speed printing capabilities, multi-material support with the Automatic Material System (AMS), and advanced features like CoreXY kinematics and built-in Lidar for print quality monitoring.' },
          { name: 'Glowforge', imageUrl: baseSkillImagePath + 'glowforge.webp', description: 'Glowforge is a line of desktop laser cutter and engraver machines. They use a focused laser beam to cut, engrave, and score a wide variety of materials like wood, acrylic, leather, and fabric, enabling precise and intricate designs.' },
          { name: 'Oscilloscope', imageUrl: baseSkillImagePath + 'oscilloscope.jpg', description: 'An oscilloscope is an electronic test instrument that allows observation of constantly varying signal voltages, usually as a two-dimensional plot of one or more signals as a function of time. It is crucial for debugging and analyzing electronic circuits.'},
          { name: 'LED Matrix', imageUrl: baseSkillImagePath + 'matrixheart.jpg', description: 'An LED matrix is a two-dimensional array of LEDs used to display patterns, characters, or animations. Each LED can be individually controlled, allowing for versatile visual outputs in various electronic projects and displays.'},
          { name: 'Pixhawk 6x', imageUrl: baseSkillImagePath + 'pixhawk.png', description: 'The Pixhawk 6X is an advanced autopilot flight controller based on the Pixhawk FMUv6X open standard. It is designed for drones and other unmanned vehicles, offering robust performance, multiple redundancy options, and a wide range of sensor interfaces.' }
        ] },
      { category: 'Languages', items: [
          { name: 'C', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/c/c-original.svg', description: 'C is a powerful, general-purpose programming language known for its efficiency and control over hardware. It is widely used for system programming, embedded systems, game development, and performance-critical applications.' },
          { name: 'C++', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/cplusplus/cplusplus-original.svg', description: 'C++ is an extension of C that adds object-oriented features. It is valued for its high performance and is extensively used in game engines, operating systems, high-frequency trading, and complex software applications.' },
          { name: 'Python', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/python/python-original.svg', description: 'Python is a high-level, interpreted programming language praised for its readability and versatility. It is popular in web development, data science, machine learning, artificial intelligence, scripting, and automation.' },
          { name: 'ROS', imageUrl: baseSkillImagePath + 'ROS.png', description: 'Robot Operating System (ROS) is a flexible framework for writing robot software. It provides a collection of tools, libraries, and conventions aimed at simplifying the task of creating complex and robust robot behavior across a wide variety of robotic platforms.' },
          { name: 'MATLAB', imageUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Matlab_Logo.png/667px-Matlab_Logo.png', description: 'MATLAB (Matrix Laboratory) is a multi-paradigm numerical computing environment and proprietary programming language. It is widely used by engineers and scientists for data analysis, algorithm development, simulation, and visualization.' },
          { name: 'Verilog', imageUrl: baseSkillImagePath + 'verilog.png', description: 'Verilog is a hardware description language (HDL) used to model electronic systems. It is most commonly used in the design and verification of digital circuits at the register-transfer level of abstraction, such as FPGAs and ASICs.' },
          { name: 'Java', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/java/java-original.svg', description: 'Java is a class-based, object-oriented programming language designed to have as few implementation dependencies as possible. It is widely used for enterprise-scale applications, Android mobile app development, and large systems development.' },
          { name: 'HTML5', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/html5/html5-original.svg', description: 'HTML5 is the latest version of HyperText Markup Language, the standard markup language for creating web pages and web applications. It introduces new elements and APIs for complex web applications, multimedia, and graphics.' },
          { name: 'CSS3', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/css3/css3-original.svg', description: 'CSS3 (Cascading Style Sheets 3) is the latest evolution of the CSS language. It is used for describing the presentation of a document written in a markup language like HTML, enabling features like animations, transitions, and responsive design.' },
          { name: 'JavaScript', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/javascript/javascript-original.svg', description: 'JavaScript is a high-level, often just-in-time compiled language that conforms to the ECMAScript specification. It is essential for creating interactive and dynamic content on websites and is also used in many non-browser environments thanks to Node.js.' },
          { name: 'SQL', imageUrl: 'https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/postgresql/postgresql-original.svg', description: 'SQL (Structured Query Language) is a domain-specific language used in programming and designed for managing data held in a relational database management system (RDBMS), or for stream processing in a relational data stream management system (RDSMS).' }
        ] },
      { category: 'Boards', items: [
          { name: 'Arduino', imageUrl: baseSkillImagePath + 'Arduino.jpg', description: 'Arduino is an open-source electronics platform based on easy-to-use hardware and software. It\'s intended for artists, designers, hobbyists, and anyone interested in creating interactive objects or environments. Popular for prototyping and educational purposes.' },
          { name: 'Raspberry Pi', imageUrl: baseSkillImagePath + 'raspberrypi.webp', description: 'The Raspberry Pi is a series of small single-board computers developed in the United Kingdom by the Raspberry Pi Foundation. It\'s widely used in robotics, IoT projects, home automation, and as a low-cost desktop computer for education.' },
          { name: 'Basys 3 FPGA', imageUrl: baseSkillImagePath + 'Basys3.webp', description: 'The Basys 3 is an entry-level FPGA development board designed for students to experience digital circuit design. It features an Artix-7 FPGA from Xilinx and is commonly used with Verilog or VHDL for learning digital logic concepts.' },
          { name: 'STM32 Nucleo', imageUrl: baseSkillImagePath + 'STM32.webp', description: 'STM32 Nucleo boards provide an affordable and flexible way for users to try out new concepts and build prototypes with STM32 microcontrollers. They feature ARM Cortex-M cores and offer various performance and power consumption options.' },
          { name: 'ESP32/8266', imageUrl: baseSkillImagePath + 'ESP32.jpg', description: 'ESP32 and ESP8266 are low-cost Wi-Fi and Bluetooth/BLE-enabled microcontrollers from Espressif Systems. They are extremely popular for IoT projects, home automation, and wireless sensor networks due to their connectivity and processing power.' },
          { name: 'Infineon PSoC 4', imageUrl: baseSkillImagePath + 'psoc4.jpg', description: 'Infineon\'s PSoC (Programmable System-on-Chip) 4 is a scalable and reconfigurable platform architecture for a new generation of mixed-signal embedded designers. It integrates an ARM Cortex-M0/M0+ core with programmable analog and digital blocks.' },
          { name: 'Parallax Propeller', imageUrl: baseSkillImagePath + 'propeller.jpg', description: 'The Parallax Propeller is a multicore microcontroller with eight 32-bit cores (cogs) that can operate simultaneously. This architecture allows for true parallel processing, making it suitable for applications requiring deterministic timing or concurrent task execution.' },
          { name: 'Jetson Nano', imageUrl: baseSkillImagePath + 'jetsonnano.jpg', description: 'NVIDIA Jetson Nano is a small, powerful computer designed to bring accelerated AI computing to embedded applications. It\'s capable of running multiple neural networks in parallel for tasks like image classification, object detection, and speech processing.' }
        ] },
      { category: 'Software', items: [
          { name: 'SolidWorks', imageUrl: baseSkillImagePath + 'SOLIDWORKS.webp', description: 'SolidWorks is a solid modeling computer-aided design (CAD) and computer-aided engineering (CAE) software. It is widely used by mechanical engineers for designing, simulating, and manufacturing products.' },
          { name: 'Altium Designer', imageUrl: baseSkillImagePath + 'altium-designer.png', description: 'Altium Designer is an electronic design automation software package for printed circuit board (PCB), FPGA and embedded software design. It provides a unified environment for schematic capture, PCB layout, and design data management.' },
          { name: 'Autodesk EAGLE', imageUrl: baseSkillImagePath + 'EAGLE.jpg', description: 'Autodesk EAGLE (Easily Applicable Graphical Layout Editor) is a scriptable electronic design automation (EDA) application with schematic capture, printed circuit board (PCB) layout, auto-router and computer-aided manufacturing (CAM) features.' },
          { name: 'Fusion 360', imageUrl: baseSkillImagePath + 'fusion360.png', description: 'Autodesk Fusion 360 is a cloud-based 3D CAD, CAM, CAE, and PCB software platform for product design and manufacturing. It combines industrial and mechanical design, simulation, collaboration, and machining in a single package.' },
          { name: 'ORcad x Capture', imageUrl: baseSkillImagePath + 'OrCADCapture.webp', description: 'Cadence Design Systems is a leading provider of electronic design automation (EDA) tools, software, and intellectual property (IP). Their tools are used for designing integrated circuits, systems on chips (SoCs), and printed circuit boards.' },
          { name: 'Webots', imageUrl: baseSkillImagePath + 'webots.png', description: 'Webots is an open-source robot simulator that provides a complete development environment to model, program and simulate robots. It offers a wide range of robot models, sensors, and actuators, and supports multiple programming languages.' },
          { name: 'Pspice/LTspice', imageUrl: baseSkillImagePath + 'LTspice.png', description: 'PSpice (Personal Simulation Program with Integrated Circuit Emphasis) is a SPICE-based analog circuit and digital logic simulation program. It is used for verifying circuit designs and predicting circuit behavior before manufacturing.' },
          { name: 'AutoCAD', imageUrl: baseSkillImagePath + 'autocad.png', description: 'AutoCAD is a commercial computer-aided design (CAD) and drafting software application. Developed and marketed by Autodesk, AutoCAD was first released in December 1982 as a desktop app running on microcomputers with internal graphics controllers.' },
          { name: 'Android Studio', imageUrl: baseSkillImagePath + 'AndroidStudio.png', description: 'Android Studio is the official integrated development environment (IDE) for Android app development. It is built on JetBrains\' IntelliJ IDEA software and designed specifically for Android development, providing tools for coding, debugging, testing, and packaging apps.' },
          { name: 'Firebase', imageUrl: baseSkillImagePath + 'firebase.png', description: 'Firebase is a comprehensive mobile and web application development platform by Google. It provides a suite of tools and services, including real-time databases, authentication, cloud functions, hosting, and analytics, to help developers build and scale apps quickly.' }
        ] },
      { category: 'Sensors', items: [
          { name: 'ATI Multi-Axis Force/Torque', imageUrl: baseSkillImagePath + 'ati_force_torque.svg', description: 'ATI Industrial Automation Multi-Axis Force/Torque sensors measure all six components of force and torque (Fx, Fy, Fz, Tx, Ty, Tz). They are used in robotics, haptics, and product testing to provide precise feedback on interaction forces.' },
          { name: 'IMU', imageUrl: baseSkillImagePath + 'imu.svg', description: 'An Inertial Measurement Unit (IMU) is an electronic device that measures and reports a body\'s specific force, angular rate, and sometimes the orientation of the body, using a combination of accelerometers, gyroscopes, and sometimes magnetometers.' },
          { name: 'Ultrasonic', imageUrl: baseSkillImagePath + 'ultrasonic_sensor.svg', description: 'Ultrasonic sensors measure distance by emitting ultrasonic sound waves and converting the reflected sound into an electrical signal. They are commonly used for object detection, range finding, and obstacle avoidance in robotics and automation.' },
          { name: 'Flex Sensor', imageUrl: baseSkillImagePath + 'flex_sensor.svg', description: 'A flex sensor is a variable resistor that changes its resistance when bent. The more it bends, the higher its resistance. They are used in robotics, gaming interfaces, and medical devices to detect bending or flexing motions.' },
          { name: 'Capacitive', imageUrl: baseSkillImagePath + 'capacitive_sensor.svg', description: 'Capacitive sensors detect changes in capacitance caused by the presence of an object or material. They are used for touch sensing (like on touchscreens), proximity detection, and liquid level sensing without direct contact.' },
          { name: 'Piezoelectric', imageUrl: baseSkillImagePath + 'piezoelectric_sensor.svg', description: 'Piezoelectric sensors leverage the piezoelectric effect, where certain materials generate an electric charge in response to applied mechanical stress. They are used as pressure sensors, accelerometers, microphones, and actuators that convert electrical energy into mechanical displacement.' }
        ] },
      { category: 'Other Tools', items: [
          { name: 'AI Vision', imageUrl: 'https://api.iconify.design/mdi/eye-check-outline.svg?color=555555', description: 'AI Vision, or Computer Vision, involves using artificial intelligence to enable computers to "see" and interpret visual information from the world, such as images and videos. This includes tasks like object recognition, image segmentation, and scene understanding.' },
          { name: 'Comm Protocols', imageUrl: 'https://api.iconify.design/mdi/serial-port.svg?color=555555', description: 'Communication protocols are sets of rules that allow two or more entities of a communications system to transmit information. Examples relevant to robotics and embedded systems include I2C, SPI, UART, CAN bus, Ethernet, Wi-Fi, and Bluetooth.' },
          { name: 'Kinematics', imageUrl: 'https://api.iconify.design/mdi/robot-industrial-outline.svg?color=555555', description: 'Kinematics is the branch of mechanics that describes the motion of points, bodies (objects), and systems of bodies (groups of objects) without considering the forces that cause them to move. In robotics, it\'s crucial for calculating robot arm positions and trajectories.' },
          { name: 'PID Control', imageUrl: 'https://api.iconify.design/mdi/tune-variant.svg?color=555555', description: 'PID (Proportional-Integral-Derivative) control is a control loop feedback mechanism widely used in industrial control systems and robotics. It continuously calculates an error value as the difference between a desired setpoint and a measured process variable and applies a correction based on proportional, integral, and derivative terms.' },
          { name: 'Kalman Filtering', imageUrl: 'https://api.iconify.design/mdi/filter-outline.svg?color=555555', description: 'A Kalman filter is an algorithm that uses a series of measurements observed over time, containing statistical noise and other inaccuracies, and produces estimates of unknown variables that tend to be more accurate than those based on a single measurement alone. It is widely used in navigation, robotics, and signal processing.' },
          { name: 'Test Automation', imageUrl: 'https://api.iconify.design/mdi/play-box-multiple-outline.svg?color=555555', description: 'Test automation is the practice of using software tools to execute pre-scripted tests on a software application before releasing it into production. It helps ensure software quality, reduce manual testing effort, and accelerate development cycles, particularly in complex embedded and robotic systems.' },
          { name: 'Telerobotics', imageUrl: 'https://api.iconify.design/mdi/gamepad-variant-outline.svg?color=555555', description: 'Telerobotics is the area of robotics concerned with the control of semi-autonomous robots from a distance, chiefly using wireless networks (like Wi-Fi, Bluetooth, the Deep Space Network, and similar) or tethered connections. It combines elements of telepresence and robotics.' },
          { name: 'Gen AI API', imageUrl: 'https://api.iconify.design/mdi/brain.svg?color=555555', description: 'Proficiency with various Generative AI APIs, including OpenAI\'s ChatGPT, Google\'s Gemini, and Anthropic\'s Claude. Experience in integrating these powerful language models for diverse applications, such as content generation, summarization, and interactive chatbots.' }
        ] }
    ];

    const header = document.querySelector('header');
    const leftObject = document.querySelector('.left-object');
    const rightObject = document.querySelector('.right-object');
    const sections = document.querySelectorAll('section');
    const aboutCardWrapper = document.querySelector('#about .about-card-wrapper');
    const majorProjectsContainer = document.getElementById('major-projects-container');
    const smallProjectsContainer = document.getElementById('small-projects-container');
    const skillsContainer = document.getElementById('skills-container');
    const resumeIframe = document.getElementById('resume-iframe');


    const modalBackdrop = document.querySelector('.modal-backdrop');
    const modalAnimator = document.querySelector('.modal-animator');
    const modalTextContentElement = document.querySelector('.modal-text-content');
    const modalCloseBtn = document.querySelector('.modal-close');
    const modalImage = document.querySelector('.modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalDescription = document.getElementById('modal-description');
    const modalLink = document.getElementById('modal-link');
    const modalTechStack = document.getElementById('modal-tech-stack');


    let isAnimating = false;
    let lastClickedCard = null;


    const populateAboutMeCard = () => {
      if (!aboutCardWrapper) return;

      const card = document.createElement('div');
      card.className = 'major-project-card project-modal-trigger about-me-card';
      card.dataset.itemId = aboutMeData.id;
      card.dataset.itemType = aboutMeData.type;

      card.innerHTML = `
        <img src="${aboutMeData.imageUrl}" alt="Aadhav Sivakumar" onerror="this.onerror=null;this.src='https://placehold.co/600x400/F7F5F2/BFA181?text=Image+Not+Found';">
        <div class="project-content">
            <h4>${aboutMeData.cardTitle}</h4>
            <p>${aboutMeData.cardTeaser}</p>
        </div>
      `;
      aboutCardWrapper.appendChild(card);
    };


    const populateProjects = () => {
      majorProjectsData.forEach((project) => {
        const card = document.createElement('div');
        card.className = 'major-project-card project-modal-trigger';
        card.dataset.itemId = project.id;
        card.dataset.itemType = 'major';
        card.innerHTML = `
          <img src="${project.imageUrl}" alt="${project.title}" onerror="this.onerror=null;this.src='https://placehold.co/600x400/F7F5F2/BFA181?text=Image+Not+Found';">
          <div class="project-content">
              <h4>${project.title}</h4>
              <p>${project.cardDescription}</p>
          </div>
        `;
        majorProjectsContainer.appendChild(card);
      });

      smallProjectsData.forEach((project) => {
        const card = document.createElement('div');
        card.className = 'small-project-card project-modal-trigger';
        card.dataset.itemId = project.id;
        card.dataset.itemType = 'small';

        // Small projects use the first text item from modalContent for card description if available
        let cardDesc = 'A cool small project.';
        if (project.modalContent && project.modalContent.length > 0 && project.modalContent[0].type === 'text') {
          cardDesc = project.modalContent[0].value.substring(0, 100) + (project.modalContent[0].value.length > 100 ? '...' : '');
        }

        card.innerHTML = `
          <img src="${project.imageUrl}" alt="${project.title}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/F7F5F2/BFA181?text=Image';">
          <div class="small-project-content">
              <h4>${project.title}</h4>
              <p>${cardDesc}</p>
          </div>
        `;
        smallProjectsContainer.appendChild(card);
      });
    };

    const populateSkills = () => {
      skillsContainer.innerHTML = '';
      skillsData.forEach(skillGroup => {
        const categoryTitleElement = document.createElement('h3');
        categoryTitleElement.className = 'skill-category-title';
        categoryTitleElement.textContent = skillGroup.category;
        skillsContainer.appendChild(categoryTitleElement);

        const grid = document.createElement('div');
        grid.className = 'skills-grid';

        skillGroup.items.forEach(item => {
          const skillCard = document.createElement('div');
          skillCard.className = 'skill-card project-modal-trigger';
          skillCard.dataset.itemType = 'skill';
          skillCard.dataset.itemId = item.name;
          skillCard.dataset.category = skillGroup.category;

          const img = document.createElement('img');
          img.src = item.imageUrl;
          img.alt = item.name;
          img.onerror = function() {
            this.onerror=null;
            this.src='https://placehold.co/80x80/F7F5F2/BFA181?text=?';
          };

          const name = document.createElement('span');
          name.textContent = item.name;

          skillCard.appendChild(img);
          skillCard.appendChild(name);
          grid.appendChild(skillCard);
        });

        skillsContainer.appendChild(grid);
      });
    };

    const handleScrollAnimations = () => {
      const scrollY = window.scrollY;
      const totalScrollableHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = totalScrollableHeight > 0 ? scrollY / totalScrollableHeight : 0;

      header.classList.toggle('scrolled', scrollY > 50);

      if (rightObject) {
        const squareTravelDistance = window.innerHeight + rightObject.offsetHeight;
        const squareY = scrollPercent * squareTravelDistance;
        const squareRotation = scrollPercent * 360;
        rightObject.style.transform = `translateY(${squareY - rightObject.offsetHeight}px) rotate(${squareRotation}deg)`;
      }

      if (leftObject) {
        const zigzagAmplitude = 70;
        const zigzagFrequency = 0.01;
        const upwardSpeed = 0.3;
        const circleRotation = scrollPercent * 200;
        const circleX = zigzagAmplitude * Math.sin(scrollY * zigzagFrequency);
        const circleY = -scrollY * upwardSpeed;
        leftObject.style.transform = `translate(${circleX}px, ${circleY}px) rotate(-${circleRotation}deg)`;
      }
    };

    const setupIntersectionObservers = () => {
      const sectionObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            sectionObserver.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });

      sections.forEach(section => sectionObserver.observe(section));

      const cardObserver = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          entry.target.classList.toggle('in-view', entry.isIntersecting);
        });
      }, { threshold: 0.1 });

      document.querySelectorAll('.major-project-card, .small-project-card, .skill-card').forEach(card => {
        cardObserver.observe(card);
      });
    };

    const openModal = (card, itemData, itemType) => {
      if (isAnimating) return;
      isAnimating = true;
      lastClickedCard = card;

      document.body.style.overflow = 'hidden';

      modalTextContentElement.querySelectorAll('.modal-dynamic-text, .modal-dynamic-image, .modal-dynamic-button').forEach(el => el.remove());
      modalDescription.textContent = '';
      modalDescription.style.display = 'none';
      modalTechStack.innerHTML = '';

      modalTitle.textContent = itemData.title || itemData.name || itemData.modalTitle;
      modalImage.src = itemData.imageUrl;
      modalImage.alt = itemData.title || itemData.name || itemData.modalTitle;
      modalImage.onerror = function() {
        this.onerror=null;
        this.src='https://placehold.co/800x600/F7F5F2/BFA181?text=Image+Not+Found';
      };

      let hasCustomButtons = false;
      let rootLink = itemData.link;

      if (itemData.modalContent && Array.isArray(itemData.modalContent)) {
        const insertionPoint = modalTechStack;

        itemData.modalContent.forEach(contentItem => {
          let el;
          if (contentItem.type === 'text') {
            el = document.createElement('p');
            el.className = 'modal-dynamic-text';
            el.textContent = contentItem.value;
          } else if (contentItem.type === 'image') {
            el = document.createElement('img');
            el.src = contentItem.value;
            el.alt = contentItem.alt || 'Modal content image';
            el.className = 'modal-dynamic-image';
            el.onerror = function() { this.src='https://placehold.co/600x400/cccccc/333333?text=Img+Error'; this.alt='Error loading image'; };
          } else if (contentItem.type === 'button') {
            el = document.createElement('a');
            el.href = contentItem.link;
            el.textContent = contentItem.text;
            el.className = 'modal-dynamic-button';
            el.target = '_blank';
            el.rel = 'noopener noreferrer';
            hasCustomButtons = true;
          }

          if (el) {
            modalTextContentElement.insertBefore(el, insertionPoint);
          }
        });
      } else {
        modalDescription.textContent = itemData.description || '';
        modalDescription.style.display = modalDescription.textContent ? 'block' : 'none';
      }

      if (hasCustomButtons || !rootLink) {
        modalLink.style.display = 'none';
      } else {
        modalLink.style.display = 'inline-block';
        modalLink.href = rootLink;
      }

      if (itemType === 'skill') {
        modalAnimator.classList.remove('project-modal');
        modalAnimator.classList.add('skill-modal');
      } else {
        modalAnimator.classList.remove('skill-modal');
        modalAnimator.classList.add('project-modal');
      }

      modalBackdrop.classList.add('visible');

      const cardRect = card.getBoundingClientRect();
      modalAnimator.classList.add('visible');
      if (lastClickedCard) lastClickedCard.classList.add('animating-out');

      let finalWidth, finalHeight, finalTop, finalLeft;

      if (itemType === 'skill') {
        finalWidth = finalHeight = Math.min(600, window.innerWidth * 0.85, window.innerHeight * 0.85);
        finalTop = (window.innerHeight - finalHeight) / 2;
        finalLeft = (window.innerWidth - finalWidth) / 2;
      } else { // 'about' and 'project' modals (expand from card)
        finalWidth = Math.min(1280, window.innerWidth * 0.9);
        finalHeight = Math.min(window.innerHeight * 0.9, 1080);
        finalTop = (window.innerHeight - finalHeight) / 2;
        finalLeft = (window.innerWidth - finalWidth) / 2;
      }

      // Set initial position and size to the card's for all types that expand from card
      modalAnimator.classList.add('no-transition');
      modalAnimator.style.top = `${cardRect.top}px`;
      modalAnimator.style.left = `${cardRect.left}px`;
      modalAnimator.style.width = `${cardRect.width}px`;
      modalAnimator.style.height = `${cardRect.height}px`;

      void modalAnimator.offsetHeight;
      modalAnimator.classList.remove('no-transition');

      requestAnimationFrame(() => {
        modalAnimator.style.top = `${finalTop}px`;
        modalAnimator.style.left = `${finalLeft}px`;
        modalAnimator.style.width = `${finalWidth}px`;
        modalAnimator.style.height = `${finalHeight}px`;
        modalAnimator.classList.add('open');
      });

      const animationDurationMs = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--animation-duration')) * 1000;
      setTimeout(() => {
        isAnimating = false;
      }, animationDurationMs);
    };

    const closeModal = () => {
      if (isAnimating || !lastClickedCard) return;
      isAnimating = true;

      const cardToClose = lastClickedCard;
      // const itemTypeOfClosedModal = cardToClose.dataset.itemType; // Not needed for differentiating close animation anymore

      // All modals (about, project, skill) now close by shrinking back to their card
      const cardRect = cardToClose.getBoundingClientRect();
      modalAnimator.style.top = `${cardRect.top}px`;
      modalAnimator.style.left = `${cardRect.left}px`;
      modalAnimator.style.width = `${cardRect.width}px`;
      modalAnimator.style.height = `${cardRect.height}px`;

      modalAnimator.classList.remove('open');
      modalBackdrop.classList.remove('visible');
      modalAnimator.classList.remove('visible');


      const animationDurationMs = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--animation-duration')) * 1000;

      setTimeout(() => {
        if(lastClickedCard) {
          lastClickedCard.classList.remove('animating-out');
        }
        document.body.style.overflow = '';

        modalTextContentElement.querySelectorAll('.modal-dynamic-text, .modal-dynamic-image, .modal-dynamic-button').forEach(el => el.remove());
        modalDescription.textContent = '';
        modalDescription.style.display = 'none';

        isAnimating = false;
        lastClickedCard = null;

      }, animationDurationMs);
    };

    const setupModalTriggers = () => {
      document.body.addEventListener('click', (e) => {
        const card = e.target.closest('.project-modal-trigger');
        if (card) {
          const itemId = card.dataset.itemId;
          const itemType = card.dataset.itemType;
          let itemData;

          if (itemType === 'major') {
            itemData = majorProjectsData.find(p => p.id.toString() === itemId);
          } else if (itemType === 'small') {
            itemData = smallProjectsData.find(p => p.id.toString() === itemId);
          } else if (itemType === 'skill') {
            const category = card.dataset.category;
            const skillCategory = skillsData.find(s => s.category === category);
            if (skillCategory) {
              itemData = skillCategory.items.find(i => i.name === itemId);
            }
          } else if (itemType === 'about') {
            itemData = aboutMeData;
          }

          if (itemData) {
            openModal(card, itemData, itemType);
          }
        }
      });


      modalBackdrop.addEventListener('click', (e) => {
        if (e.target === modalBackdrop) {
          closeModal();
        }
      });
      modalCloseBtn.addEventListener('click', closeModal);
      window.addEventListener('keydown', (e) => {
        if(e.key === 'Escape' && modalBackdrop.classList.contains('visible')) {
          closeModal();
        }
      });
    };


    if (resumeIframe) {
      resumeIframe.src = resumePdfUrl;
    }

    populateAboutMeCard();
    populateProjects();
    populateSkills();

    let raf;
    window.addEventListener('scroll', () => {
      if (raf) window.cancelAnimationFrame(raf);
      raf = window.requestAnimationFrame(handleScrollAnimations);
    }, { passive: true });

    setupIntersectionObservers();
    setupModalTriggers();
  });
</script>
</body>
</html>
